######################################## ex_202211171135120000 ########################################
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	beavis.zen
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	bong
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	bud-frogs
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	bunny
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	cheese
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	cower
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	daemon
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	default
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	docker
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	dragon
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	dragon-and-cow
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	elephant
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	elephant-in-snake
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	eyes
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	flaming-sheep
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	ghostbusters
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	head-in
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	hellokitty
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	kiss
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	kitty
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	koala
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	kosh
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	luke-koala
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	meow
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	milk
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	moofasa
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	moose
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	mutilated
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	ren
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	satanic
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	sheep
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	skeleton
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	small
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	sodomized
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	squirrel
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	stegosaurus
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	stimpy
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	supermilker
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	surgery
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	telebears
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	three-eyes
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	turkey
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	turtle
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	tux
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	udder
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	vader
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	vader-koala
.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json#animal	www
https://moirai2.github.io/schema/daemon/command	.moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json
https://moirai2.github.io/schema/daemon/execid	ex_202211171135120000
https://moirai2.github.io/schema/daemon/execute	completed
https://moirai2.github.io/schema/daemon/processtime	0
https://moirai2.github.io/schema/daemon/rootdir	/root
https://moirai2.github.io/schema/daemon/timecompleted	1668652515
https://moirai2.github.io/schema/daemon/timeended	1668652515
https://moirai2.github.io/schema/daemon/timeregistered	1668652513
https://moirai2.github.io/schema/daemon/timestarted	1668652515
https://moirai2.github.io/schema/daemon/workdir	.moirai2/ex_202211171135120000
######################################## time ########################################
registered	2022/11/17 11:35:13
start	2022/11/17 11:35:15
end	2022/11/17 11:35:15
completed	2022/11/17 11:35:15
######################################## insert ########################################
cowsay	db/animal	beavis.zen
cowsay	db/animal	bong
cowsay	db/animal	bud-frogs
cowsay	db/animal	bunny
cowsay	db/animal	cheese
cowsay	db/animal	cower
cowsay	db/animal	daemon
cowsay	db/animal	default
cowsay	db/animal	docker
cowsay	db/animal	dragon
cowsay	db/animal	dragon-and-cow
cowsay	db/animal	elephant
cowsay	db/animal	elephant-in-snake
cowsay	db/animal	eyes
cowsay	db/animal	flaming-sheep
cowsay	db/animal	ghostbusters
cowsay	db/animal	head-in
cowsay	db/animal	hellokitty
cowsay	db/animal	kiss
cowsay	db/animal	kitty
cowsay	db/animal	koala
cowsay	db/animal	kosh
cowsay	db/animal	luke-koala
cowsay	db/animal	meow
cowsay	db/animal	milk
cowsay	db/animal	moofasa
cowsay	db/animal	moose
cowsay	db/animal	mutilated
cowsay	db/animal	ren
cowsay	db/animal	satanic
cowsay	db/animal	sheep
cowsay	db/animal	skeleton
cowsay	db/animal	small
cowsay	db/animal	sodomized
cowsay	db/animal	squirrel
cowsay	db/animal	stegosaurus
cowsay	db/animal	stimpy
cowsay	db/animal	supermilker
cowsay	db/animal	surgery
cowsay	db/animal	telebears
cowsay	db/animal	three-eyes
cowsay	db/animal	turkey
cowsay	db/animal	turtle
cowsay	db/animal	tux
cowsay	db/animal	udder
cowsay	db/animal	vader
cowsay	db/animal	vader-koala
cowsay	db/animal	www
######################################## bash ########################################
#!/bin/bash
export PATH=/root/.moirai2/ex_202211171135120000/bin:/root:/root/bin:/root/.moirai2/bin:$PATH
cmdurl=".moirai2/cmd/1eac8553c3c79f212474b54c7dae3487_774.json"
execid="ex_202211171135120000"
workdir="/root/.moirai2/ex_202211171135120000"
rootdir="/root"
tmpdir="/root/.moirai2/ex_202211171135120000/tmp"
jobfile=".moirai2/ctrl/job/ex_202211171135120000.txt"
animal=$tmpdir/animal
########## init ##########
cd $rootdir
touch $workdir/status.txt
touch $workdir/log.txt
function status() { echo "$1	"`date +%s` >> $workdir/status.txt ; }
function record() { echo "$1	$2" >> $workdir/log.txt ; }
mkdir -p $workdir/bin
cat<<EOF>$workdir/bin/listAnimals.pl
#!/usr/bin/perl

my @animals=();
while(<STDIN>){
	if(/files/){next;}
	my @tokens=split(/\\s/);
	push(@animals,@tokens);
}
print join(" ",@animals)."\\n";
EOF
chmod 755 $workdir/bin/listAnimals.pl
mkdir -p /tmp/$execid
ln -s /tmp/$execid $tmpdir
status start
########## command ##########
animal=(`cowsay -l | listAnimals.pl`)
#############################
status end
if [[ "$(declare -p animal)" =~ "declare -a" ]]; then
for out in ${animal[@]} ; do
record "$cmdurl#animal" "$out"
echo "insert cowsay->animal->$out"
done
else
record "$cmdurl#animal" "$animal"
echo "insert cowsay->animal->$animal"
fi
rm $workdir/tmp
if [ -z "$(ls -A /tmp/$execid)" ]; then
rmdir /tmp/$execid
else
mv /tmp/$execid $workdir/tmp
fi
status=""
if [ -z "$status" ]; then
if [ -s $workdir/stderr.txt ]; then
status=error
fi
fi
if [ -z "$status" ]; then
status=completed
fi
status $status
sleep 1
touch $workdir/status.txt
