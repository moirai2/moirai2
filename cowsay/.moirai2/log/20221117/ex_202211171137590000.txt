######################################## ex_202211171137590000 ########################################
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#out1	output.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/beavis.zen.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/bong.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/bud-frogs.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/bunny.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/cheese.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/cower.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/daemon.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/default.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/docker.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/dragon.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/dragon-and-cow.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/elephant.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/elephant-in-snake.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/eyes.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/flaming-sheep.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/ghostbusters.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/head-in.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/hellokitty.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/kiss.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/kitty.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/koala.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/kosh.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/luke-koala.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/meow.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/milk.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/moofasa.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/moose.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/mutilated.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/ren.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/satanic.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/sheep.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/skeleton.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/small.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/sodomized.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/squirrel.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/stegosaurus.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/stimpy.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/supermilker.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/surgery.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/telebears.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/three-eyes.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/turkey.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/turtle.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/tux.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/udder.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/vader.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/vader-koala.txt
.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json#output	out/www.txt
https://moirai2.github.io/schema/daemon/command	.moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json
https://moirai2.github.io/schema/daemon/execid	ex_202211171137590000
https://moirai2.github.io/schema/daemon/execute	completed
https://moirai2.github.io/schema/daemon/processtime	0
https://moirai2.github.io/schema/daemon/rootdir	/Users/ah3q/Sites/moirai2/cowsay
https://moirai2.github.io/schema/daemon/timecompleted	1668652680
https://moirai2.github.io/schema/daemon/timeended	1668652680
https://moirai2.github.io/schema/daemon/timeregistered	1668652680
https://moirai2.github.io/schema/daemon/timestarted	1668652680
https://moirai2.github.io/schema/daemon/workdir	.moirai2/ex_202211171137590000
######################################## time ########################################
registered	2022/11/17 11:38:00
start	2022/11/17 11:38:00
end	2022/11/17 11:38:00
completed	2022/11/17 11:38:00
######################################## bash ########################################
#!/bin/bash
export PATH=/Users/ah3q/Sites/moirai2/cowsay:/Users/ah3q/Sites/moirai2/cowsay/bin:/Users/ah3q/Sites/moirai2/cowsay/.moirai2/bin:$PATH
cmdurl=".moirai2/cmd/7408d202cd62b537d64a93519a56d085_526.json"
execid="ex_202211171137590000"
workdir=".moirai2/ex_202211171137590000"
rootdir="/Users/ah3q/Sites/moirai2/cowsay"
tmpdir=".moirai2/ex_202211171137590000/tmp"
jobfile=".moirai2/ctrl/job/ex_202211171137590000.txt"
output=("out/beavis.zen.txt" "out/bong.txt" "out/bud-frogs.txt" "out/bunny.txt" "out/cheese.txt" "out/cower.txt" "out/daemon.txt" "out/default.txt" "out/docker.txt" "out/dragon.txt" "out/dragon-and-cow.txt" "out/elephant.txt" "out/elephant-in-snake.txt" "out/eyes.txt" "out/flaming-sheep.txt" "out/ghostbusters.txt" "out/head-in.txt" "out/hellokitty.txt" "out/kiss.txt" "out/kitty.txt" "out/koala.txt" "out/kosh.txt" "out/luke-koala.txt" "out/meow.txt" "out/milk.txt" "out/moofasa.txt" "out/moose.txt" "out/mutilated.txt" "out/ren.txt" "out/satanic.txt" "out/sheep.txt" "out/skeleton.txt" "out/small.txt" "out/sodomized.txt" "out/squirrel.txt" "out/stegosaurus.txt" "out/stimpy.txt" "out/supermilker.txt" "out/surgery.txt" "out/telebears.txt" "out/three-eyes.txt" "out/turkey.txt" "out/turtle.txt" "out/tux.txt" "out/udder.txt" "out/vader.txt" "out/vader-koala.txt" "out/www.txt")
out1=$tmpdir/out1.txt
########## init ##########
cd $rootdir
touch $workdir/status.txt
touch $workdir/log.txt
function status() { echo "$1	"`date +%s` >> $workdir/status.txt ; }
function record() { echo "$1	$2" >> $workdir/log.txt ; }
mkdir -p /tmp/$execid
ln -s /tmp/$execid $tmpdir
status start
########## command ##########
cat ${output[*]} > $out1
#############################
status end
mv $out1 output.txt
out1=output.txt
if [[ "$(declare -p out1)" =~ "declare -a" ]]; then
for out in ${out1[@]} ; do
record "$cmdurl#out1" "$out"
done
else
record "$cmdurl#out1" "$out1"
fi
rm $workdir/tmp
if [ -z "$(ls -A /tmp/$execid)" ]; then
rmdir /tmp/$execid
else
mv /tmp/$execid $workdir/tmp
fi
status=""
if [ -z "$status" ]; then
if [ -s $workdir/stderr.txt ]; then
status=error
fi
fi
if [ -z "$status" ]; then
status=completed
fi
status $status
sleep 1
touch $workdir/status.txt
