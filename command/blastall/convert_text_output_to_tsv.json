{"https://moirai2.github.io/schema/daemon/input":"$input","https://moirai2.github.io/schema/daemon/bash":["output=\"$workdir/output.txt\"","extract.pl < $input > $output"],"https://moirai2.github.io/schema/daemon/script":{"https://moirai2.github.io/schema/daemon/script/name":"extract.pl","https://moirai2.github.io/schema/daemon/script/code":["#!/usr/bin/perl","use strict 'vars';","print \"id\\tname\\tqlen\\tslen\\tscore\\tbits\\texpect\\tstrand\\tidentities\\tidentities%\\tgaps\\tgaps%\\tqstart\\tqend\\tsstart\\tsend\\tquery\\tmatch\\tsubject\\n\";","my$hash={};","while(<STDIN>){","chomp;","if(/^Length=(\\d+)$/){$hash->{\"qlength\"}=$1;}","if(/^ALIGNMENTS$/){last;}","}","while(<STDIN>){","chomp;","if(/^\\>(\\S+)\\s+(.+)$/){","printresult($hash);","$hash={\"id\"=>$1,\"name\"=>$2,\"qlength\"=>$hash->{\"qlength\"},\"slength\"=>$hash->{\"slength\"}};","}elsif(/^Length=(\\d+)$/){","$hash->{\"slength\"}=$1;","}elsif(/^\\s+Score\\s+=\\s+([\\d\\.]+)\\s+bits\\s+\\((\\d+)\\),\\s+Expect\\s+=\\s+(.+)$/){","printresult($hash);","$hash={\"id\"=>$hash->{\"id\"},\"name\"=>$hash->{\"name\"},\"qlength\"=>$hash->{\"qlength\"},\"slength\"=>$hash->{\"slength\"},\"score\"=>$1,\"bits\"=>$2,\"expect\"=>$3};","}elsif(/^\\s+Identities\\s+=\\s+(.+)\\s+\\((.+%)\\),\\s+Gaps\\s+=\\s+(.+)\\s+\\((.+%)\\)/){","$hash->{\"identities\"}=$1;","$hash->{\"identities%\"}=$2;","$hash->{\"gaps\"}=$3;","$hash->{\"gaps%\"}=$4;","}elsif(/^\\s+Strand=(.+)$/){","$hash->{\"strand\"}=$1;","}elsif(/^Query(\\s+)(\\d+)(\\s+)(\\S+)(\\s+)(\\d+)$/){","if(!exists($hash->{\"qstart\"})){$hash->{\"qstart\"}=$2;}","$hash->{\"query\"}.=$4;","$hash->{\"qend\"}=$6;","my$length=length(\"Query$1$2$3\");","my$match=<STDIN>;chomp($match);","$hash->{\"match\"}.=substr($match,$length);","}elsif(/^Sbjct\\s+(\\d+)\\s+(\\S+)\\s+(\\d+)$/){","if(!exists($hash->{\"sstart\"})){$hash->{\"sstart\"}=$1;}","$hash->{\"subject\"}.=$2;","$hash->{\"send\"}=$3;","}","}","printresult($hash);","sub printresult{","my$hash=shift();","if(scalar(keys(%{$hash}))<=4){return;}","print $hash->{\"id\"}.\"\\t\".$hash->{\"name\"}.\"\\t\".$hash->{\"qlength\"}.\"\\t\".$hash->{\"slength\"}.\"\\t\".$hash->{\"score\"}.\"\\t\".$hash->{\"bits\"}.\"\\t\".$hash->{\"expect\"}.\"\\t\".$hash->{\"strand\"}.\"\\t\".$hash->{\"identities\"}.\"\\t\".$hash->{\"identities%\"}.\"\\t\".$hash->{\"gaps\"}.\"\\t\".$hash->{\"gaps%\"}.\"\\t\".$hash->{\"qstart\"}.\"\\t\".$hash->{\"qend\"}.\"\\t\".$hash->{\"sstart\"}.\"\\t\".$hash->{\"send\"}.\"\\t\".$hash->{\"query\"}.\"\\t\".$hash->{\"match\"}.\"\\t\".$hash->{\"subject\"}.\"\\n\";","}"]},"https://moirai2.github.io/schema/daemon/output":"$output"}
