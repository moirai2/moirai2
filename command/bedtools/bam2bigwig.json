{"https://moirai2.github.io/schema/daemon/input":"$bam","https://moirai2.github.io/schema/daemon/bash":["basename=`basename $bam .bam`","bedGraph=\"$workdir/$basename.bedGraph\"","bigWig=\"$workdir/$basename.bigWig\"","genomefile=\"$workdir/genome.txt\";","samtools view -H $bam | extract.pl > $genomefile","bedtools bamtobed -i $bam | bedtools sort -i '-' | bedtools genomecov -bg -i '-' -g $genomefile > $bedGraph ","bedGraphToBigWig $bedGraph $genomefile $bigWig","rm $bedGraph","rm $genomefile"],"https://moirai2.github.io/schema/daemon/script":{"https://moirai2.github.io/schema/daemon/script/name":"extract.pl","https://moirai2.github.io/schema/daemon/script/code":["#!/usr/bin/perl","my @chromosomes={};","while(<STDIN>){","chomp;","if(/^\\@SQ\\t(.+)$/){","my $chromosome;","my $size;","foreach my $token(split(/\\t/,$1)){","my ($key,$val)=split(/\\:/,$token);","if($key eq \"SN\"){$chromosome=$val;}","if($key eq \"LN\"){$size=$val;}","}","$chromosomes->{$chromosome}=$size;","}","}","foreach my $chromosome(sort{$a cmp $b}keys(%{$chromosomes})){","my $size=$chromosomes->{$chromosome};","print \"$chromosome\\t$size\\n\";","}"]},"https://moirai2.github.io/schema/daemon/return":"$bigWig","https://moirai2.github.io/schema/daemon/software":["bedtools","bedGraphToBigWig"]}
